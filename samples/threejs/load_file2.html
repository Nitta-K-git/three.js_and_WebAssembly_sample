<!-- 
    https://hakuhin.jp/js/dialog.html
    https://www.e-loop.jp/knowledges/35/
    ローカルのファイルをテキスト or ArrayBufferとして読み込むコード
 -->

<meta charset="utf-8" />
<html>

<body>
    <form>
        <input type="file" id="aaa" multiple> <br>
        <input type="button" id="bbb" value="ファイルを開く" style="width:200px; height:50px;">
    </form>
    <script type="text/javascript">
        // <!--

        // ------------------------------------------------------------
        // 各エレメントを取得する
        // ------------------------------------------------------------
        var input_file = document.getElementById("aaa");
        var input_button = document.getElementById("bbb");

        // ------------------------------------------------------------
        // 値が変化した時に実行されるイベント
        // ------------------------------------------------------------
        input_file.onchange = function (e) {

            // ファイルが選択されたか
            if (input_file.value) {
                console.log("ファイルが選択された:" + input_file.value);
            } else {
                console.log("ファイルが未選択");
            }

            // ファイルが選択されたか
            if (!(input_file.value)) return;

            // 読み込んだファイルの情報をすべて表示
            console.log(e.target.files);

            // テキストとして読み込んでログに表示
            var file = e.target.files;
            var reader = new FileReader();

            reader.readAsText(file[0]);
            reader.onload = function () {
                console.log(reader.result);
            }

            // ArrayBufferとして読み込み
            reader.readAsArrayBuffer(file[0]);
            reader.onload = function () {
                console.log(reader.result);
            }

            // FileList オブジェクトを取得する
            // var file_list = input_file.files;
            // if (!file_list) return;

            // var i;
            // var num = file_list.length;
            // for (i = 0; i < num; i++) {
            //     // File オブジェクトを取得する
            //     var file = file_list[i];

            //     // 出力テスト
            //     console.log("--- id:" + i);
            //     console.log("name:" + file.name);
            //     console.log("size:" + file.size);
            //     console.log("type:" + file.type);
            // }
        };
        // ------------------------------------------------------------
        // クリックした時に実行されるイベント
        // ------------------------------------------------------------
        input_button.onclick = function (e) {
            // ファイル選択ダイアログを開く
            input_file.click();
        };
    //-->
    </script>
</body>

</html>